import React from 'react';
import Head from 'next/head';
import Image from 'next/image';
import { FaChevronRight, FaAngleRight, FaTag, FaBolt } from 'react-icons/fa';

import Rodape from '../components/Rodape';
import Menu from '../components/Menu';
import Link from '../components/Link';
import Card from '../components/Card';
import HeaderNotification from '../components/HeaderNotification';

import styles from '../styles/Home.module.scss';
import Testimony from '../components/Testimony';
import { useState, useEffect } from 'react';

import { Swiper, SwiperSlide } from 'swiper/react';
import SwiperCore, { Pagination, Autoplay, Navigation, A11y } from 'swiper/core';
import 'swiper/swiper.min.css';
import 'swiper/components/pagination/pagination.min.css';
import 'swiper/components/scrollbar/scrollbar.min.css';

SwiperCore.use([Navigation, Pagination, Autoplay, A11y]);

export default function Home() {

  const [menu, setMenu] = useState([]);
  const [testimony, setTestimony] = useState([]);

  const params = {
    spaceBetween: 50,
    slidesPerView: 1,
    centeredSlides: true,
    pagination: {
      clickable: true,
    },
    autoplay: {
      delay: 3000,
      disableOnInteraction: false,
      waitForTransition: true,
    },
    loop: true,
    speed: 2000,
  }

  useEffect(() => {

    fetch("https://graphql.datocms.com/", {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'Accept': 'application/json',
        'Authorization': '0ee5f218c9a8a1ee1ec74f445ca6b3',
      },
      body: JSON.stringify({
        'query': `query {
          allMenus {
            id
            title
            description
            imagemurl {
              url
            }
            pricenew
            priceold
          }
          allTestimonies {
            id
            opinion
            avatarurl {
              url
            }
            city
            state
            author
          }
        }`})
    }).then(async (res) => {
      const dados = await res.json();

      const allTestimony = dados.data.allTestimonies
      const allMenus = dados.data.allMenus;

      setMenu(allMenus);
      setTestimony(allTestimony);
    });

  }, [])

  return (
    <>
      <Head>
        <title>Pizzaria Inácio - Faça já o seu pedido</title>
        <meta name="description" content="Generated by create next app" />
      </Head>

      <HeaderNotification />
      <Menu />

      <main id={styles.main} className="gap">

        <section className={styles.introduction}>
          <div className="container">
            <div className={styles.bannerIntroduction}>
              <div className={styles.bannerIntroductionImage}>
                <img  src="/pizza-sharing.svg" alt="Mulheres comendo pizza"/>
              </div>
              <div className={styles.bannerIntroductionContent}>
                <h3 className={styles.titleBanner}>Super oferta!!!</h3>
                <p className={styles.bannerIntroductionText}>
                  Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s,
                </p>

                <div className={styles.bannerIntroductionFooter}>
                  <Link to="/" className="btn">About more</Link>
                  <Link to="/" className="btn btn-outline">Add cart</Link>
                </div>
              </div>
            </div>
          </div>
        </section>

        <section className={styles.promotion} >
          <div className="container">
            <ul className={styles.promotionsList}>
              <li>
                <span className={styles.promotionIcon}>
                  <FaTag />
                </span>
                <p>
                  <span>Obá, desconto!</span>
                  <Link to="/">
                    Entre em contato agora
                    <FaAngleRight />
                  </Link>
                </p>
              </li>
              <li>
                <span className={styles.promotionIcon}>
                  <FaBolt />
                </span>
                <p>
                  <span>Entrega rápida!</span>
                  <Link to="/">
                    Saiba mais
                    <FaAngleRight />
                  </Link>
                </p>
              </li>
            </ul>

          </div>
        </section>

        <section className={'section ' + styles.portfolio}>
          <div className="container">
            <h2 className="title">Telecombo semanal!!!</h2>
            <div className={styles.cards}>
              {menu.map((item, index) => {
                return (
                  index < 6 && (
                    <Card data={item} key={item.id} />
                  )
                )
              })}
            </div>

            <footer>
              <div className={styles.callAction}>
                <p>Não ficou satisfeito com tele combo? temos outras opções!!!</p>
                <a href="" className="btn btn-yellow cta">
                  Ver cardápio completo
                  <FaChevronRight />
                </a>
              </div>
            </footer>
          </div>
        </section>

        <section className={'section ' + styles.testimonials}>
          <div className="container">
            <h2 className="title">Testimonials</h2>
            <div className={styles.testimonia}>
              <Swiper {...params}>
                {testimony.map((clienteInformation) => {
                  console.log(clienteInformation)
                  return (
                    <SwiperSlide key={clienteInformation.id}>
                      <span><Testimony clienteInformation={clienteInformation} /></span>
                    </SwiperSlide>
                  );
                })}
              </Swiper>
            </div>
          </div>
        </section>

        <section className={styles.banner}>
          <div className="container">
            <div className={styles.bannerContent}>
              <h3 className={styles.bannerTitle}>Tele premium <br /> oferta!!!<br /></h3>
              <div className={styles.bannerValue}>
                <span>
                  R$
                </span>
                <span>
                  59,90
                </span>
              </div>
            </div>
          </div>
        </section>

      </main>

      <Rodape />
    </>
  )
}
